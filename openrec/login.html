<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Style Css -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="css/login.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <title>ITEM 2021 - Ini Talkshow Edukasi Movie</title>
    <link rel="icon" href="asset/LOGO/ITEM/icon-item.png">
</head>
<body>
    <div class="loading-wrapper">
        <div class="loading-inner">
            <img src="asset/LOGO/ITEM/item1.png" alt="" height="80" class="mb-5" loading="lazy">
            <br>
            <div class="spinner-border text-light mb-4" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-md-4"></div>
            <div class="col-md-4 text-center">
                <img src="asset/LOGO/ITEM/item1.png" width="200" class="mb-2" lt="">
                <h1 class="title-h1" >Open Recruitment 2021</h1>
                <div class="mb-4"></div>
                <div class="card p-4 text-left">
                        <div class="form-group">
                            <label class="title" for="nrp">Nrp (Nomor Induk Mahasiswa) </label>
                            <input type="text" class="form-control" id="nrp" aria-describedby="emailHelp" placeholder="Example: c14190xxx">
                        </div>
                        <div class="form-group">
                            <label class="title" for="password-field">Password</label>
                            <input type="password" class="form-control" id="password" placeholder="Your Password">
                        </div>
			            <div class="g-recaptcha mb-3" data-sitekey="6Lc902wUAAAAAFt2dJea0wenAWXF3yP38ieIWcuU" data-callback="callback"></div>
                        <button type="submit" id="login-button" class="btn btn-primary title">Submit</button>
                </div>
            </div>
            <div class="col-md-4"></div>
        </div>
    </div>
    <img src="asset/KARAKTER/karakter2.png"id="karakter2">
    
    



    <!-- Javascript -->
    <script src='https://www.google.com/recaptcha/api.js'></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script> 
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        $(window).on("load",function(){
            $('.loading-wrapper').fadeOut("slow");
        });
        $(document).ready(function(){
            //Initial AOS
                AOS.init();
            //Login Form
            

            $("#login-button").click(function(){ 
                var nrp = $("#nrp").val();
                nrp = nrp.toLowerCase();
                var password = $("#password").val();
                var captcha = grecaptcha.getResponse();
                console.log(nrp);
                console.log(password);

                function loadingButton(){
                    $("#login-button").append('<span id="spinner" class="spinner-grow spinner-grow-sm ml-3" role="status" aria-hidden="true"></span>');
                };   

                $.ajax({
                    url: 'api/login.php',
                    method: 'POST',
                    beforeSend: loadingButton(),
                    data: {
                        nrp: nrp,
                        password: password,
                        recaptcha: captcha
                    },
                    success: function(data) {
                        $("#spinner").remove();
                        var response = JSON.parse(data);
                        if(response['status'] == 0){
                            alert(response['error']);
                        }else{
                            alert(response['error']);
                            window.location = response['redirect'];
                            console.log(response['error'])
                        }
                    
                    },
                    error: function($xhr, textStatus, errorThrown) {
                        $("#spinner").remove();
                        alert($xhr.responseJSON['error']);
                    }
                }); 
            });

        });
        
    </script>
</body>
</html>